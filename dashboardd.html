<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>TerraBook Dashboard</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/simple-datatables@latest/dist/style.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/file-saver"></script>
  <script src="https://cdn.jsdelivr.net/npm/simple-datatables@latest" defer></script>
  <style>
    * {
      box-sizing: border-box;
      font-family: 'Poppins', sans-serif;
    }
    body {
      margin: 0;
      background: #f4fdf7;
      display: flex;
      height: 100vh;
      justify-content: flex-start;
      padding-top: 134px;
      color: #000;
      transition: background 0.5s ease, color 0.5s ease;
    }
    .sidebar {
      width: 220px;
      background-color: #2e7d32;
      color: white;
      padding: 20px;
      height: 932px;
      position: fixed;
      top: 134px;
      left: 80px;
      border-radius: 30px;
      box-shadow: 0px 44px 84px 6px #d8d9db;
      transition: background-color 0.3s ease;
    }
    .sidebar h2 {
      font-size: 24px;
      margin-bottom: 30px;
      user-select: none;
    }
    .sidebar a {
      display: block;
      color: white;
      text-decoration: none;
      margin-bottom: 15px;
      cursor: pointer;
      padding: 8px 12px;
      border-radius: 8px;
      transition: background-color 0.3s, transform 0.2s;
      user-select: none;
    }
    .sidebar a:hover {
      background-color: #4caf50;
      transform: translateX(5px);
    }
    .sidebar a.active {
      background-color: #388e3c;
      font-weight: 700;
      pointer-events: none;
    }
    .main {
      position: absolute;
      width: 1440px;
      height: 932px;
      left: 320px; /* 80 + 220 + 20px gap */
      top: 134px;
      background: #FFFFFF;
      box-shadow: 0px 44px 84px 6px #d8d9db;
      border-radius: 30px;
      padding: 30px 40px;
      overflow-y: auto;
      transition: all 0.4s ease-in-out, background 0.5s ease;
    }
    .section-content {
      display: none;
      animation: fadeIn 0.8s ease-in-out;
    }
    .section-content.active {
      display: block;
    }
    @keyframes fadeIn {
      0% {opacity: 0; transform: translateY(20px);}
      100% {opacity: 1; transform: translateY(0);}
    }
    h3 {
      margin-top: 0;
      margin-bottom: 10px;
    }
    .filter-container {
      margin-bottom: 20px;
    }
    .filter-container select {
      padding: 8px;
      font-size: 14px;
      border-radius: 6px;
      border: 1px solid #ccc;
    }
    .chart-container {
      max-width: 600px;
      margin-top: 20px;
    }
    canvas {
      width: 100% !important;
      height: 300px !important;
    }
    .download-btn {
      margin-top: 20px;
      padding: 10px 15px;
      background: #4caf50;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      transition: background-color 0.3s;
    }
    .download-btn:hover {
      background: #388e3c;
    }
    /* Style the datatable */
    table.dataTable-table {
      width: 100% !important;
      margin-top: 20px;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 2px 6px rgb(0 0 0 / 0.1);
    }
    /* Settings form styles */
    #settingsForm fieldset {
      border: none;
      margin-bottom: 20px;
    }
    #settingsForm legend {
      font-weight: 600;
      margin-bottom: 10px;
      font-size: 1.1em;
    }
    #settingsForm label {
      display: block;
      margin-bottom: 6px;
      font-weight: 500;
    }
    #settingsForm input[type="text"],
    #settingsForm input[type="email"],
    #settingsForm select {
      width: 100%;
      max-width: 400px;
      padding: 8px;
      border: 1px solid #ccc;
      border-radius: 6px;
      font-size: 14px;
      margin-bottom: 12px;
      box-sizing: border-box;
      transition: border-color 0.3s;
    }
    #settingsForm input[type="checkbox"] {
      margin-right: 8px;
      vertical-align: middle;
    }
    #saveMessage {
      color: green;
      margin-top: 10px;
      display: none;
      font-weight: 600;
    }
  </style>
</head>
<body>

  <nav class="sidebar">
    <h2>TerraBook</h2>
    <a href="#" onclick="showTab('dashboard'); return false;" class="active">Dashboard</a>
    <a href="#" onclick="showTab('bookings'); return false;">Bookings</a>
    <a href="#" onclick="showTab('listings'); return false;">Listings</a>
    <a href="#" onclick="showTab('customers'); return false;">Customers</a>
    <a href="#" onclick="showTab('revenue'); return false;">Revenue</a>
    <a href="#" onclick="showTab('impact'); return false;">Impact</a>
    <a href="#" onclick="showTab('reports'); return false;">Reports</a>
    <a href="#" onclick="showTab('settings'); return false;">Settings</a>
  </nav>

  <main class="main">
    <!-- Dashboard Tab -->
    <section id="dashboard" class="section-content active">
      <h3>Dashboard</h3>
      <p>Overview of key metrics and trends.</p>
      <div class="filter-container">
        <label for="timeRange">Select Time Range:</label>
        <select id="timeRange" onchange="updateChartRange()">
          <option value="10">Last 10</option>
          <option value="20">Last 20</option>
          <option value="30">Last 30</option>
        </select>
      </div>
      <div class="chart-container">
        <canvas id="liveChart"></canvas>
        <canvas id="pieChart" style="margin-top: 40px;"></canvas>
        <canvas id="barChart" style="margin-top: 40px;"></canvas>
      </div>
      <button class="download-btn" onclick="downloadCharts()">Download Charts as PNG</button>
    </section>

    <!-- Bookings Tab -->
    <section id="bookings" class="section-content">
      <h3>Bookings</h3>
      <table id="bookingTable" class="datatable">
        <thead>
          <tr>
            <th>Booking ID</th>
            <th>Customer</th>
            <th>Destination</th>
            <th>Date</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody>
          <tr><td>1</td><td>Alice</td><td>Eco Lodge</td><td>2025-07-01</td><td>Confirmed</td></tr>
          <tr><td>2</td><td>Bob</td><td>Forest Retreat</td><td>2025-07-05</td><td>Pending</td></tr>
          <tr><td>3</td><td>Clara</td><td>River Camp</td><td>2025-07-08</td><td>Cancelled</td></tr>
          <tr><td>4</td><td>David</td><td>Mountain Cabin</td><td>2025-07-10</td><td>Confirmed</td></tr>
          <tr><td>5</td><td>Eva</td><td>Beach Resort</td><td>2025-07-12</td><td>Pending</td></tr>
        </tbody>
      </table>
    </section>

    <!-- Listings Tab -->
    <section id="listings" class="section-content">
      <h3>Listings</h3>
      <p>Mock data: 36 active listings.</p>
    </section>

    <!-- Customers Tab -->
    <section id="customers" class="section-content">
      <h3>Customers</h3>
      <p>Mock data: 1,230 customers.</p>
    </section>

    <!-- Revenue Tab -->
    <section id="revenue" class="section-content">
      <h3>Revenue</h3>
      <p>Revenue this month: R56,000.</p>
    </section>

    <!-- Impact Tab -->
    <section id="impact" class="section-content">
      <h3>Impact</h3>
      <p>Carbon saved: 3,200kg, Jobs created: 28.</p>
    </section>

    <!-- Reports Tab -->
    <section id="reports" class="section-content">
      <h3>Reports</h3>
      <p>Monthly booking and revenue reports available.</p>
    </section>

    <!-- Settings Tab -->
    <section id="settings" class="section-content">
      <h3>Settings</h3>
      <form id="settingsForm">
        <fieldset>
          <legend>User Profile</legend>
          <label for="userName">Name:</label>
          <input type="text" id="userName" name="userName" value="Sibulelo Mkhize" />
          <label for="userEmail">Email:</label>
          <input type="email" id="userEmail" name="userEmail" value="sibulelo@example.com" />
        </fieldset>

        <fieldset>
          <legend>Notifications</legend>
          <label><input type="checkbox" id="notifyEmail" checked /> Email Notifications</label>
          <label><input type="checkbox" id="notifySMS" /> SMS Notifications</label>
        </fieldset>

        <fieldset>
          <legend>Appearance</legend>
          <label for="themeSelect">Theme:</label>
          <select id="themeSelect">
            <option value="light">Light</option>
            <option value="dark">Dark</option>
          </select>
        </fieldset>

        <fieldset>
          <legend>Language</legend>
          <select id="languageSelect">
            <option value="en">English</option>
            <option value="za">Zulu</option>
            <option value="fr">French</option>
            <option value="es">Spanish</option>
          </select>
        </fieldset>

        <button type="submit" class="download-btn" style="max-width: 150px;">Save Settings</button>
        <p id="saveMessage">Settings saved!</p>
      </form>
    </section>
  </main>

  <script>
    let maxPoints = 10;
    let liveChart;

    function showTab(tabId) {
      // Update sidebar active link
      document.querySelectorAll('.sidebar a').forEach(link => {
        link.classList.remove('active');
      });
      document.querySelector(`.sidebar a[onclick*="${tabId}"]`).classList.add('active');

      // Show the requested tab content
      document.querySelectorAll('.section-content').forEach(section => {
        section.classList.remove('active');
      });
      document.getElementById(tabId).classList.add('active');
    }

    function updateChartRange() {
      maxPoints = parseInt(document.getElementById('timeRange').value);
    }

    function startLiveChart() {
      const ctx = document.getElementById('liveChart').getContext('2d');
      const data = {
        labels: [],
        datasets: [{
          label: 'Live Bookings',
          borderColor: '#4caf50',
          backgroundColor: 'rgba(76, 175, 80, 0.2)',
          data: []
        }]
      };
      liveChart = new Chart(ctx, {
        type: 'line',
        data: data,
        options: {
          animation: true,
          responsive: true,
          scales: {
            x: { display: true },
            y: { display: true, beginAtZero: true }
          }
        }
      });

      setInterval(() => {
        const now = new Date().toLocaleTimeString();
        const value = Math.floor(Math.random() * 100);
        if (liveChart.data.labels.length >= maxPoints) {
          liveChart.data.labels.shift();
          liveChart.data.datasets[0].data.shift();
        }
        liveChart.data.labels.push(now);
        liveChart.data.datasets[0].data.push(value);
        liveChart.update();
      }, 2000);
    }

    function startPieChart() {
      const ctx = document.getElementById('pieChart').getContext('2d');
      new Chart(ctx, {
        type: 'pie',
        data: {
          labels: ['Hotels', 'Adventures', 'Restaurants'],
          datasets: [{
            label: 'Revenue Sources',
            data: [30000, 16000, 10000],
            backgroundColor: [
              'rgba(76, 175, 80, 0.6)',
              'rgba(255, 193, 7, 0.6)',
              'rgba(244, 67, 54, 0.6)'
            ],
            borderColor: [
              '#4caf50', '#ffc107', '#f44336'
            ],
            borderWidth: 1
          }]
        },
        options: {
          responsive: true,
          plugins: {
            legend: {
              position: 'bottom'
            }
          }
        }
      });
    }

    function startBarChart() {
      const ctx = document.getElementById('barChart').getContext('2d');
      new Chart(ctx, {
        type: 'bar',
        data: {
          labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
          datasets: [{
            label: 'Monthly Revenue',
            data: [10000, 12000, 9000, 14000, 11000, 15000],
            backgroundColor: 'rgba(33, 150, 243, 0.6)',
            borderColor: '#2196f3',
            borderWidth: 1
          }]
        },
        options: {
          responsive: true,
          scales: {
            y: { beginAtZero: true }
          }
        }
      });
    }

    function downloadCharts() {
      const canvasList = ['liveChart', 'pieChart', 'barChart'];
      canvasList.forEach(id => {
        const canvas = document.getElementById(id);
        canvas.toBlob(blob => {
          saveAs(blob, `${id}.png`);
        });
      });
    }

    // Handle theme toggling
    function applyTheme(theme) {
      if (theme === 'dark') {
        document.body.style.background = '#121212';
        document.body.style.color = '#eee';
        document.querySelector('.main').style.background = '#1e1e1e';
      } else {
        document.body.style.background = '#f4fdf7';
        document.body.style.color = '#000';
        document.querySelector('.main').style.background = '#fff';
      }
    }

    document.addEventListener('DOMContentLoaded', () => {
      startLiveChart();
      startPieChart();
      startBarChart();

      // Initialize datatable for bookings
      const bookingTable = document.querySelector("#bookingTable");
      if (bookingTable) {
        new simpleDatatables.DataTable(bookingTable);
      }

      // Settings form logic
      const form = document.getElementById('settingsForm');
      const saveMessage = document.getElementById('saveMessage');
      const themeSelect = document.getElementById('themeSelect');

      applyTheme(themeSelect.value);

      themeSelect.addEventListener('change', (e) => {
        applyTheme(e.target.value);
      });

      form.addEventListener('submit', (e) => {
        e.preventDefault();
        // Here you would normally save to backend
        saveMessage.style.display = 'block';
        setTimeout(() => {
          saveMessage.style.display = 'none';
        }, 3000);
      });
    });
  </script>
</body>
</html>

